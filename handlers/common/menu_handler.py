from telegram import Update
from telegram.ext import ContextTypes
import logging
from handlers.user.tournaments import show_tournaments_list
from handlers.user.profile import show_profile

logger = logging.getLogger(__name__)

async def handle_menu_buttons(update: Update, context: ContextTypes.DEFAULT_TYPE):
    """–û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–Ω–æ–ø–æ–∫ –≥–ª–∞–≤–Ω–æ–≥–æ –º–µ–Ω—é"""
    try:
        text = update.message.text
        
        if text == "üèÜ –¢—É—Ä–Ω–∏—Ä—ã":
            await show_tournaments_list(update, context)
            
        elif text == "üë§ –ú–æ–π –ø—Ä–æ—Ñ–∏–ª—å":
            await show_profile(update, context)
            
        elif text == "‚ÑπÔ∏è –ü–æ–º–æ—â—å":
            await show_help(update, context)
            
        elif text == "üè† –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é":
            # –ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ–º —Ñ—É–Ω–∫—Ü–∏—é start_command
            from handlers.user.start import start_command
            await start_command(update, context)
            
    except Exception as e:
        logger.error(f"Error in handle_menu_buttons: {e}")
        await update.message.reply_text("–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞")

async def show_help(update: Update, context: ContextTypes.DEFAULT_TYPE):
    """–ü–æ–∫–∞–∑–∞—Ç—å –ø–æ–º–æ—â—å"""
    from utils.keyboards import get_main_menu_keyboard
    
    help_text = """‚ÑπÔ∏è –ü–æ–º–æ—â—å –ø–æ –±–æ—Ç—É

üéæ –û–°–ù–û–í–ù–´–ï –§–£–ù–ö–¶–ò–ò:

üèÜ –¢—É—Ä–Ω–∏—Ä—ã - –ø—Ä–æ—Å–º–æ—Ç—Ä –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —Ç—É—Ä–Ω–∏—Ä–æ–≤
- –°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –∞–∫—Ç–∏–≤–Ω—ã—Ö —Ç—É—Ä–Ω–∏—Ä–æ–≤
- –î–µ—Ç–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∫–∞–∂–¥–æ–º —Ç—É—Ä–Ω–∏—Ä–µ
- –ó–∞–ø–∏—Å—å –Ω–∞ —É—á–∞—Å—Ç–∏–µ (–æ—Å–Ω–æ–≤–Ω—ã–µ –º–µ—Å—Ç–∞ –∏ —Ä–µ–∑–µ—Ä–≤)
- –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ –∑–∞—è–≤–∫–∏ –∏ —Ç–∞–π–º–µ—Ä–∞ –æ–ø–ª–∞—Ç—ã
- –û—Ç–º–µ–Ω–∞ —É—á–∞—Å—Ç–∏—è

üë§ –ú–æ–π –ø—Ä–æ—Ñ–∏–ª—å - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ª–∏—á–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
- –ü—Ä–æ—Å–º–æ—Ç—Ä —Å–≤–æ–∏—Ö –¥–∞–Ω–Ω—ã—Ö (–§–ò–û, —Ç–µ–ª–µ—Ñ–æ–Ω)
- –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –§–ò–û

üè† –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é - –≤–æ–∑–≤—Ä–∞—Ç –∫ –≥–ª–∞–≤–Ω–æ–º—É —ç–∫—Ä–∞–Ω—É

üìù –ü–†–û–¶–ï–°–° –£–ß–ê–°–¢–ò–Ø –í –¢–£–†–ù–ò–†–ï:
1. –í—ã–±–µ—Ä–∏—Ç–µ —Ç—É—Ä–Ω–∏—Ä –∏–∑ —Å–ø–∏—Å–∫–∞
2. –ù–∞–∂–º–∏—Ç–µ "–£—á–∞—Å—Ç–≤–æ–≤–∞—Ç—å –≤ —Ç—É—Ä–Ω–∏—Ä–µ"
3. –£ –≤–∞—Å –µ—Å—Ç—å –≤—Ä–µ–º—è –¥–ª—è –æ–ø–ª–∞—Ç—ã (—É–∫–∞–∑–∞–Ω–æ –≤ –∑–∞—è–≤–∫–µ)
4. –ü–æ—Å–ª–µ –æ–ø–ª–∞—Ç—ã –¥–æ–∂–¥–∏—Ç–µ—Å—å –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –æ—Ä–≥–∞–Ω–∏–∑–∞—Ç–æ—Ä–∞
5. –°—Ç–∞—Ç—É—Å –±—É–¥–µ—Ç –æ–±–Ω–æ–≤–ª–µ–Ω: üü¢ - –æ–¥–æ–±—Ä–µ–Ω–æ, üü° - –æ–∂–∏–¥–∞–µ—Ç

üí° –ü–û–õ–ï–ó–ù–ê–Ø –ò–ù–§–û–†–ú–ê–¶–ò–Ø:
- –í—Å–µ–≥–æ 16 –æ—Å–Ω–æ–≤–Ω—ã—Ö –º–µ—Å—Ç + 5 —Ä–µ–∑–µ—Ä–≤–Ω—ã—Ö
- –í—Ä–µ–º—è –Ω–∞ –æ–ø–ª–∞—Ç—É –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–æ (—É–∫–∞–∑–∞–Ω–æ –≤ –∑–∞—è–≤–∫–µ)
- –ú–æ–∂–Ω–æ –æ—Ç–º–µ–Ω–∏—Ç—å —É—á–∞—Å—Ç–∏–µ –¥–æ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è
- –ü–æ—Å–ª–µ –æ–¥–æ–±—Ä–µ–Ω–∏—è –º–µ—Å—Ç–æ –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–æ

‚ùì –ü–æ –≤–æ–ø—Ä–æ—Å–∞–º –æ–±—Ä–∞—â–∞–π—Ç–µ—Å—å –∫ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ç–æ—Ä–∞–º —Ç—É—Ä–Ω–∏—Ä–∞."""
    
    await update.message.reply_text(help_text, reply_markup=get_main_menu_keyboard())